# 批量分析使用说明

## 功能说明

批量分析脚本会自动扫描 `/Users/yanwenqi/Desktop/Video-Eval` 目录下的所有视频文件，对每个视频执行完整的分析，并生成Excel/CSV报告。

## 使用方法

### 方法1: 直接运行Python脚本

```bash
cd /Users/yanwenqi/Desktop/Video-Eval
.venv/bin/python batch_analyze.py
```

### 方法2: 使用Shell脚本

```bash
cd /Users/yanwenqi/Desktop/Video-Eval
./run_batch_analysis.sh
```

## 分析内容

每个视频会执行以下4项分析：

1. **基础分析** - 帧率、分辨率、时长等基本信息
2. **FPS动态分析** - 按秒分析FPS变化，包括变异分析
3. **帧动态分析** - 亮度、对比度、运动强度分析
4. **运动质量分析** - 4个核心指标：
   - 有效FPS & 时间戳抖动
   - 重复/近似重复帧检测
   - 运动连续性/Jerkiness
   - 果冻效应/滚动快门失真

## 输出文件

分析完成后会生成：

1. **CSV报告** (`视频分析报告_YYYYMMDD_HHMMSS.csv`)
   - 包含所有分析结果
   - 可用Excel直接打开
   - 按模型和总分排序

2. **JSON备份** (`视频分析结果_YYYYMMDD_HHMMSS.json`)
   - 完整的原始数据
   - 可用于进一步分析

3. **Excel报告** (如果安装了pandas)
   - 包含"全部结果"和"模型统计"两个工作表
   - 更美观的格式

## 模型识别

脚本会根据文件名自动识别模型类型：
- **即梦**: jimeng, jim, 即梦
- **可灵**: kling, 可灵, keling
- **Gen-2**: gen2, gen-2, runway
- **PixVerse**: pixverse, pix
- **Pika**: pika
- **Haiper**: haiper, hiper

## 评分系统

综合评分（总分100分）包括：

- **FPS稳定性评分** (25分) - 基于变异系数
- **时间戳抖动评分** (15分) - 基于PTS抖动
- **重复帧评分** (15分) - 基于重复帧率
- **运动连续性评分** (25分) - 基于光流分析
- **果冻效应评分** (10分) - 基于Wobble检测
- **视频质量评分** (10分) - 基于分辨率

**评级标准**:
- 90-100分: 优秀
- 80-89分: 良好
- 70-79分: 一般
- 60-69分: 较差
- <60分: 很差

## 性能提示

- 分析时间取决于视频数量和长度
- 使用采样率5可以加快速度（已默认启用）
- 对于大量视频，建议在后台运行

## 注意事项

1. 确保已安装所有依赖：`pip install opencv-python numpy matplotlib`
2. 如需Excel格式，安装：`pip install pandas openpyxl`
3. CSV文件可以用Excel直接打开，功能相同
4. 分析过程会显示进度，请耐心等待

## 示例输出

报告包含以下列：
- 文件名、模型、文件路径
- 基础信息（帧率、分辨率、时长等）
- FPS动态分析（平均值、标准差、变异系数等）
- 时间戳抖动（有效FPS、抖动标准差等）
- 重复帧检测（完全重复、近似重复、总重复率）
- 帧动态（亮度、对比度、运动强度）
- 运动连续性（连续性分数、Jerkiness分数）
- 果冻效应（失真分数）
- 各项评分和总分、评级
